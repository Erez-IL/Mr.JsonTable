(function(n){n.fn.mrjsontable=function(t){var e=this.selector,i=n.extend({},n.fn.mrjsontable.defaults,t),r=n("<div>").attr("data-so","A").addClass("mrjt"),u=n("<div>").addClass("legend"),f=n("<table>").addClass(i.tableClass),o=n("<thead>"),s=n("<tr>");return n.each(i.columns,function(t,r){var f=n("<th>").attr("data-i",t),o=n("<input>",{type:"checkbox",id:"cb"+e+t,value:t,checked:!r.starthidden,"data-i":t}).bind("change",i.onHiddenCBChange).appendTo(u),h=n("<label />",{"for":"cb"+e+t,text:r.heading}).appendTo(u);r.starthidden&&f.hide();r.sortable?n("<a>",{"class":"s-init",href:"#","data-i":t,"data-t":r.type}).text(r.heading).bind("click",i.onSortClick).appendTo(f):n("<span>").text(r.heading).appendTo(f);f.appendTo(s)}),s.appendTo(o),o.appendTo(f),n.each(i.data,function(t,r){var u=n("<tr>").attr("data-i",t);n.each(i.columns,function(t,i){var f=n("<td>").text(r[i.data]).attr("data-i",t);i.starthidden&&f.hide();f.appendTo(u)});u.appendTo(f)}),r.append(u),r.append(f),this.append(r)};n.fn.mrjsontable.defaults={tableClass:"table",onHiddenCBChange:function(){var t=n(this).parents(".mrjt"),i=n(this).attr("data-i");n(this).is(":checked")?(n("td[data-i='"+i+"']",t).show(),n("th[data-i='"+i+"']",t).show()):(n("td[data-i='"+i+"']",t).hide(),n("th[data-i='"+i+"']",t).hide())},onSortClick:function(){var t=n(this).parents(".mrjt"),f=t.attr("data-so"),r,u;n(".s-init",t).removeClass("s-A s-D");n(this).addClass("s-"+f);var e=n(this).attr("data-t"),o=n(this).attr("data-i"),i=[];for(n("tbody tr",t).each(function(t,r){var u=n("td",r).eq(o),s=u.parent().attr("data-i"),f=null;switch(e){case"string":f=u.text();break;case"int":f=parseInt(u.text());break;case"float":f=parseFloat(u.text());break;case"datetime":f=new Date(u.text());break;default:f=u.text()}i.push({tr_id:s,val:f})}),f=="A"?(i.sort(function(n,t){return n.val>t.val?1:n.val<t.val?-1:0}),t.attr("data-so","D")):(i.sort(function(n,t){return n.val<t.val?1:n.val>t.val?-1:0}),t.attr("data-so","A")),r=0;r<i.length;r++)u=n("tr[data-i='"+i[r].tr_id+"']",t),u.detach(),n("tbody",t).append(u);return!1}}})(jQuery);